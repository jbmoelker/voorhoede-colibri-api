{% extends "components/page.html" %}

{% block title %}Voorhoede Colibri API{% endblock %}
{% block meta %}
  <link rel="preload" href="/assets/images/api-diagram.png" as="image">
  <link rel="preload" href="/assets/fonts/raleway-extrabold-webfont.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/assets/fonts/raleway-medium-webfont.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/assets/fonts/notoserif-regular-webfont.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="prefetch" href="/api/{{ restVersion }}/swagger.json" as="fetch" type="application/json">
{% endblock %}

{% block content %}
  <main>
    <header class="page-header">
      <img alt="" src="/assets/images/api-diagram.png" class="page-header__image">
      <h1 class="page-header__title">Access Voorhoede site content via a RESTful and GraphQL interface</h1>
    </header>

    <section class="page-content">
      <h2 id="rest">RESTful API</h2>
      <p>...</p>
      <ul>
        <li>Dedicated (versioned) endpoint for each collection and singleton model (e.g. <code>{{ baseUrl }}/api/{{ restVersion }}/posts</code>).</li>
        <li>Requests can be refined using search query parameters (e.g. <code>?fields=title,slug</code>). These are specified per endpoint.</li>
        <li>Currently all endpoints only support <code>GET</code> requests.</li>
      </ul>
      <h3>Example use</h3>
      <pre class="code-block"><code>const apiUrl = `{{ baseUrl }}/api/{{ restVersion }}`
fetch(`${apiUrl}/posts?fields=title,slug,publishDate`, {
    method: 'GET',
    headers: {
      'Accept': 'application/json',
      'Content-Type': 'application/json'
    }
  })
  .then(response => response.json())
  .then(json => console.log(json))</code></pre>
      <details class="details">
        <summary>Output</summary>
        <pre class="code-block"><code>[
  {
    "publishDate": "2018-01-24",
    "slug": "real-time-communication-with-server-sent-events",
    "title" : "Real-time communication with Server Sent Events"
  },
  { ... },
  { ... },
]</code></pre>
      </details>
      <a href="/api/{{ restVersion }}" class="button button--primary">Explore REST API</a>
    </section>

    <section class="page-content">
      <h2 id="graphql">GraphQL API</h2>
      <p>...</p>
      <ul>
        <li>Single endpoint for every request (<code>{{ baseUrl }}/graphql</code>).</li>
        <li>Requests can be refined precisely via the <code>query</code> sent as request <code>body</code>.</li>
        <li>All requests must be <code>POST</code> requests.</li>
      </ul>
      <h3>Example use</h3>
      <pre class="code-block"><code>const apiUrl = `{{ baseUrl }}/graphql`
const query = `
  query {
    blog { title subtitle description keywords }
    posts {
      title slug publishDate
      authors {
        name
        image { url }
      }
    }
  }
`
fetch(apiUrl, {
    method: 'POST',
    headers: {
      'Accept': 'application/json',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ query })
  })
  .then(response => response.json())
  .then(json => console.log(json.data))</code></pre>
      <details class="details">
        <summary>Output</summary>
        <pre class="code-block"><code>...</code></pre>
      </details>
      <a href="/graphql/" class="button button--primary">Explore GraphQL API</a>
    </section>

  </main>
{% endblock %}
